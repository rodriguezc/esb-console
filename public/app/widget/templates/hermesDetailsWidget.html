<div style="width: 100%; height: 100%;">
    <script type="dojo/require">at: "dojox/mvc/at"</script>
    <script type="dojo/require">Filter: "gridx/modules/Filter"</script>
    <script type="dojo/require">Cache: "gridx/core/model/cache/Sync"</script>
    <script type="dojo/require">Sort: "gridx/modules/SingleSort"</script>
    <script type="dojo/require">QuickFilter: "gridx/modules/filter/QuickFilter"</script>
    <script type="dojo/require">IndirectSelect: "gridx/modules/IndirectSelect"</script>
    <script type="dojo/require">RowHeader: "gridx/modules/RowHeader"</script>
    <script type="dojo/require">ExtendedSelectRow: "gridx/modules/extendedSelect/Row"</script>
    <script type="dojo/require">on: "dojo/on"</script>

    <div data-dojo-type="dijit/Dialog" data-dojo-attach-point="importDialog" data-dojo-id="importDialog" title="Import messages" style="width:400px;height: 250px">

        <form method="post"
              action="/services/environnements/${env}/brokers/${broker}/queues/${queueName}/messages/import"
              enctype="multipart/form-data"
             >

            <input name="uploadedfile" multiple="true" type="file" data-dojo-type="dojox/form/Uploader"
                                                                   data-dojo-props="baseWidgetId: this, onComplete: this._onFileUploadComplete"
                   label="Select Some Files" id="${id}_uploader" />
            <input type="submit" label="Upload" data-dojo-type="dijit.form.Button" />
        </form>
        <div style="width: 100%;height:165px;overflow: auto">
            <div data-dojo-type="dojox/form/uploader/FileList" uploaderId="${id}_uploader"></div>

        </div>
    </div>


    <span style="font-weight: bold">Size:</span>
    <span data-dojo-type="dojox/mvc/Output" data-dojo-props="value: at(this, 'size')"></span>
    <span style="font-weight: bold">Consumers:</span>
    <span data-dojo-type="dojox/mvc/Output" data-dojo-props="value: at(this, 'consumersSize')"></span>

    <div data-dojo-type="dijit/Dialog" data-dojo-id="consumersDialog" title="Consumers" style="width:400px">
        <ul data-dojo-type="dojox/mvc/Repeat" data-dojo-props="exprchar: '#',children: at(this, 'consumers')" >
            <li>
                <span data-dojo-type="dojox/mvc/Output" data-dojo-props="value: at('#{this.index}', 'name')"></span>
            </li>
        </ul>
    </div>

    <button data-dojo-type="dijit/form/Button"
            data-dojo-props="iconClass:'zoomIcon', showLabel: false" type="button"
            onclick="consumersDialog.show();">
    </button>



    <span style="font-weight: bold">Dequeue:</span>
    <span data-dojo-type="dojox/mvc/Output" data-dojo-props="value: at(this, 'dequeue')"></span>
    <span style="font-weight: bold">Enqueue:</span>
    <span data-dojo-type="dojox/mvc/Output" data-dojo-props="value: at(this, 'enqueue')"></span>
    <span style="font-weight: bold">InFlight:</span>
    <span data-dojo-type="dojox/mvc/Output" data-dojo-props="value: at(this, 'inflight')"></span>
    <span style="font-weight: bold">Average enqueue time ms:</span>
    <span data-dojo-type="dojox/mvc/Output" data-dojo-props="value: at(this, 'averageEnqueueTime')"></span>


    <div style="margin-top: 3px">
        <div data-dojo-type="dijit/MenuBar">
            <div data-dojo-type="dijit/MenuBarItem" data-dojo-attach-event="onClick: _onRefreshClick">Refresh</div>
            <div data-dojo-type="dijit/MenuBarItem" data-dojo-attach-event="onClick: _onDeleteClick">Delete</div>
            <div data-dojo-type="dijit/MenuBarItem" data-dojo-attach-event="onClick: _onPurgeClick">Purge</div>
            <div data-dojo-type="dijit/MenuBarItem"  onclick="importDialog.show();">Import messages</div>

            <!--div data-dojo-type="dijit/MenuBarItem">Purge</div>
            <div data-dojo-type="dijit/MenuBarItem">Move all</div-->
        </div>

             <span data-dojo-id="messagesStore" data-dojo-type="dojo/store/JsonRest"
                   data-dojo-props="target: '/services/environnements/${env}/brokers/${broker}/queues/${queueName}/messages'">
             </span>
           <span data-dojo-id="messagesOStore" data-dojo-type="dojo/data/ObjectStore"
                 data-dojo-props="objectStore: messagesStore">
             </span>
    </div>

    <div data-dojo-id="store" data-dojo-type="dojo/store/Memory" data-dojo-props="data: []"></div>

    <div data-dojo-type="gridx/Grid"
         data-dojo-attach-point="messagesGridWidget"
         data-dojo-props="store: store,
                             cacheClass: Cache,
                                modules: [
                                            Sort,
                                            Filter,
                                            QuickFilter,
                                            IndirectSelect,
                                            RowHeader,
                                            ExtendedSelectRow
                                         ],
                              structure: [
                                            {field: 'position', name: '#'},
                                            {field: 'type', name: 'Type'},
                                            {field: 'id', name: 'jmsMessageId'},
                                            {field: 'jmsTimestamp', name: 'jmsTimestamp'}


        ]
        "style="width: 100%;height: 90%;margin-top: 1px"></div>

        <div data-dojo-type="dijit/Dialog" data-dojo-attach-point="messageDetailsDialog" title="Consumers" style="width:400px;height: 400px">
            Details
        </div>



</div>